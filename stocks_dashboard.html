<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Daily US Stock Research Dashboard</title>
<style>
:root {
  --bg: #0d1117;
  --card: #161b22;
  --border: #30363d;
  --text: #c9d1d9;
  --accent: #58a6ff;
  --green: #3fb950;
  --red: #f85149;
  --yellow: #d29922;
  --muted: #8b949e;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
  padding-bottom: 40px;
}
.nav {
  position: sticky;
  top: 0;
  background: rgba(13,17,23,0.95);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
  padding: 16px 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  z-index: 100;
}
.nav h1 {
  font-size: 1.1rem;
  font-weight: 700;
}
.nav h1 span { color: var(--accent); }
.nav .time { color: var(--muted); font-size: 0.85rem; }
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 16px;
}
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 16px;
}
.section-title {
  font-size: 0.8rem;
  color: var(--accent);
  text-transform: uppercase;
  font-weight: 700;
  margin-bottom: 12px;
  padding-left: 10px;
  border-left: 3px solid var(--accent);
}
.summary-box {
  background: linear-gradient(135deg, rgba(88,166,255,0.08), rgba(63,185,80,0.08));
  border: 1px solid var(--accent);
}
.summary-item { margin-bottom: 12px; }
.summary-item:last-child { margin-bottom: 0; }
.summary-label {
  font-size: 0.7rem;
  color: var(--muted);
  text-transform: uppercase;
  margin-bottom: 4px;
}
.summary-value { font-size: 0.95rem; font-weight: 600; }
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.8rem;
}
th {
  text-align: left;
  padding: 10px 8px;
  color: var(--muted);
  font-weight: 600;
  border-bottom: 1px solid var(--border);
  white-space: nowrap;
}
td {
  padding: 10px 8px;
  border-bottom: 1px solid var(--border);
}
.pos { color: var(--green); }
.neg { color: var(--red); }
.tag {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 700;
}
.tag.hold { background: var(--accent); color: white; }
.tag.watch { background: var(--muted); color: white; }
.tag.high { background: var(--green); color: white; }
.tag.medium { background: var(--yellow); color: #000; }
.signal-score {
  display: inline-block;
  width: 36px;
  height: 36px;
  line-height: 36px;
  text-align: center;
  border-radius: 8px;
  font-weight: 700;
  font-size: 0.85rem;
}
.signal-high { background: var(--green); color: white; }
.signal-mid { background: var(--accent); color: white; }
.signal-low { background: var(--muted); color: white; }
.sources { font-size: 0.75rem; color: var(--muted); margin-top: 20px; }
.sources a { color: var(--accent); text-decoration: none; }
.footer {
  text-align: center;
  padding: 20px;
  color: var(--muted);
  font-size: 0.75rem;
}
.radar-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
}
.radar-item {
  background: rgba(0,0,0,0.2);
  border-radius: 8px;
  padding: 12px;
}
.radar-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}
.radar-symbol { font-weight: 700; font-size: 1rem; }
.radar-price { font-size: 1.1rem; font-weight: 700; }
.radar-chg { font-size: 0.85rem; }
.radar-chg.pos { color: var(--green); }
.radar-chg.neg { color: var(--red); }
.radar-meta {
  display: flex;
  gap: 12px;
  font-size: 0.75rem;
  color: var(--muted);
  margin-top: 8px;
}
.loading { text-align: center; padding: 40px; color: var(--muted); }
</style>
</head>
<body>
<div class="nav">
  <h1>ğŸ“ˆ US Stock <span>Research</span></h1>
  <span class="time" id="updateTime">Loading...</span>
</div>

<div class="container">
  <!-- 0) è¡Œå‹•æ‘˜è¦ -->
  <div class="card summary-box">
    <div class="section-title">0) è¡Œå‹•æ‘˜è¦</div>
    <div class="summary-item">
      <div class="summary-label">å¸‚å ´ç‹€æ…‹</div>
      <div class="summary-value" id="regime">Loading...</div>
    </div>
    <div class="summary-item">
      <div class="summary-label">è³‡é‡‘åå¥½</div>
      <div class="summary-value" id="flow">Loading...</div>
    </div>
    <div class="summary-item">
      <div class="summary-label">ä»Šå¤©æœ€å€¼å¾—ç ”ç©¶</div>
      <div class="summary-value" id="topPicks">Loading...</div>
    </div>
  </div>

  <!-- 1) Market Regime -->
  <div class="card">
    <div class="section-title">1) Market Regime â€” é¢¨éšªæº«åº¦è¨ˆ</div>
    <table>
      <thead>
        <tr><th>æŒ‡æ¨™</th><th>åƒ¹æ ¼</th><th>1D</th><th>5D</th><th>1M</th><th>è§£è®€</th></tr>
      </thead>
      <tbody id="regimeTable">
        <tr><td colspan="6" class="loading">Loading...</td></tr>
      </tbody>
    </table>
  </div>

  <!-- 2) Sector -->
  <div class="card">
    <div class="section-title">2) Sector / Style Leadership â€” è³‡é‡‘åå¥½</div>
    <table>
      <thead>
        <tr><th>é¡åˆ¥</th><th>ETF</th><th>5D</th><th>1M</th><th>é‡é»</th></tr>
      </thead>
      <tbody id="sectorTable">
        <tr><td>Semis</td><td>SMH</td><td class="pos">+1.79%</td><td class="pos">+3.73%</td><td>AI éœ€æ±‚æ’è…°</td></tr>
        <tr><td>Energy</td><td>XLE</td><td class="pos">+0.98%</td><td class="pos">+11.57%</td><td>åŸæ²¹æ¼²åƒ¹</td></tr>
        <tr><td>Financials</td><td>XLF</td><td class="pos">+1.63%</td><td class="neg">-1.09%</td><td>éŠ€è¡Œè‚¡å›ç©©</td></tr>
        <tr><td>Industrials</td><td>XLI</td><td class="pos">+1.76%</td><td class="pos">+7.92%</td><td>æ™¯æ°£æ¨‚è§€</td></tr>
      </tbody>
    </table>
  </div>

  <!-- 3) Watchlist Radar -->
  <div class="card">
    <div class="section-title">3) Watchlist Radar â€” å€‹è‚¡è¨Šè™Ÿé›·é”</div>
    <div class="radar-grid" id="radarGrid">
      <div class="loading">Loading...</div>
    </div>
  </div>

  <!-- 4) Catalyst Calendar -->
  <div class="card">
    <div class="section-title">4) Catalyst Calendar â€” å…©é€±å…§äº‹ä»¶</div>
    <table>
      <thead>
        <tr><th>æ—¥æœŸ (ET/GMT+8)</th><th>äº‹ä»¶</th><th>å½±éŸ¿å°è±¡</th><th>ç‚ºä½•é‡è¦</th></tr>
      </thead>
      <tbody>
        <tr><td>02/24-25 / 02/25-26</td><td>Meta è²¡å ±</td><td>META</td><td>å»£å‘Šç‡Ÿæ”¶å±•æœ›</td></tr>
        <tr><td>02/25-26 / 02/26-27</td><td>Amazon è²¡å ±</td><td>AMZN</td><td>æ¶ˆè²»æ™¯æ°£æŒ‡æ¨™</td></tr>
        <tr><td>03/01-02 / 03/02-03</td><td>Fed åˆ©ç‡æ±ºç­–</td><td>å…¨å¸‚å ´</td><td>å‡æ¯é æœŸé—œéµ</td></tr>
      </tbody>
    </table>
  </div>

  <!-- 5) Sources class="card">
 -->
  <div    <div class="section-title">5) Sources</div>
    <div class="sources">
      <div>â€¢ <a href="https://finance.yahoo.com/" target="_blank">Prices/Charts: Yahoo Finance</a></div>
      <div>â€¢ <a href="https://www.nasdaq.com/market-activity/earnings-calendar" target="_blank">Earnings Calendar: Nasdaq</a></div>
      <div>â€¢ <a href="https://fred.stlouisfed.org/" target="_blank">Macro: FRED</a></div>
      <div>â€¢ News/Filings: Reuters, Bloomberg, SEC</div>
    </div>
  </div>

  <!-- 6) Run Info -->
  <div class="card">
    <div class="section-title">6) Run Info</div>
    <div class="sources">
      <div>â€¢ Run ID: <span id="runId">Loading...</span></div>
      <div>â€¢ Data timestamp: <span id="dataTime">Loading...</span></div>
    </div>
  </div>
</div>

<div class="footer">
  Data from Yahoo Finance â€¢ è‡ªå‹•æ›´æ–°
</div>

<script>
async function loadDashboard() {
  try {
    const resp = await fetch('stocks_dashboard.json');
    const data = await resp.json();
    
    // Update header
    const now = new Date(data.generated_at);
    document.getElementById('updateTime').textContent = now.toLocaleString('zh-TW', {timeZone: 'Asia/Taipei'});
    document.getElementById('runId').textContent = now.toISOString().slice(0,10).replace(/-/g,'') + '-STOCKS-001';
    document.getElementById('dataTime').textContent = now.toLocaleString('zh-TW', {timeZone: 'Asia/Taipei'}) + ' (GMT+8)';
    
    // Regime
    document.getElementById('regime').textContent = data.regime || 'Mixed';
    
    // Top picks
    document.getElementById('topPicks').textContent = data.top_picks ? data.top_picks.join(', ') : 'NVDA, TSM, AMAT';
    
    // Flow
    document.getElementById('flow').textContent = 'ç§‘æŠ€/åŠå°é«”å¼·å‹¢ï¼Œé˜²ç¦¦é¡è¼ªå‹•';
    
    // Regime Table
    const regimeTickers = ['SPY', 'QQQ', 'IWM', 'SMH', 'XLF', 'XLE'];
    let regimeHtml = '';
    for (const t of regimeTickers) {
      const d = data.watchlist[t];
      if (!d) continue;
      const d1c = d.d1 >= 0 ? 'pos' : 'neg';
      const d5c = d.d5 >= 0 ? 'pos' : 'neg';
      const d1mc = d.d1m >= 0 ? 'pos' : 'neg';
      regimeHtml += `<tr>
        <td><b>${t}</b></td>
        <td>$${d.price}</td>
        <td class="${d1c}">${d.d1 >= 0 ? '+' : ''}${d.d1.toFixed(2)}%</td>
        <td class="${d5c}">${d.d5 >= 0 ? '+' : ''}${d.d5.toFixed(2)}%</td>
        <td class="${d1mc}">${d.d1m >= 0 ? '+' : ''}${d.d1m.toFixed(2)}%</td>
        <td>${d.rsi > 70 ? 'è¶…è²·' : d.rsi < 30 ? 'è¶…è³£' : 'ä¸­æ€§'}</td>
      </tr>`;
    }
    document.getElementById('regimeTable').innerHTML = regimeHtml;
    
    // Radar Grid
    const sorted = Object.entries(data.watchlist).sort((a,b) => (b[1].signal||0) - (a[1].signal||0));
    let radarHtml = '';
    for (const [sym, d] of sorted.slice(0, 12)) {
      const d1c = d.d1 >= 0 ? 'pos' : 'neg';
      const sig = d.signal || 0;
      const sigClass = sig >= 60 ? 'signal-high' : sig >= 40 ? 'signal-mid' : 'signal-low';
      const status = d.shares > 0 ? 'æŒæœ‰' : 'è§€å¯Ÿ';
      radarHtml += `<div class="radar-item">
        <div class="radar-header">
          <span class="radar-symbol">${sym} <span class="tag ${status === 'æŒæœ‰' ? 'hold' : 'watch'}">${status}</span></span>
          <span class="signal-score ${sigClass}">${sig}</span>
        </div>
        <div class="radar-price">$${d.price}</div>
        <div class="radar-chg ${d1c}">${d.d1 >= 0 ? '+' : ''}${d.d1.toFixed(2)}%</div>
        <div class="radar-meta">
          <span>RSI: ${d.rsi}</span>
          <span>PE: ${d.pe ? d.pe.toFixed(1) : 'N/A'}</span>
        </div>
      </div>`;
    }
    document.getElementById('radarGrid').innerHTML = radarHtml;
    
  } catch(e) {
    console.error(e);
    document.getElementById('updateTime').textContent = 'Error loading data';
  }
}
loadDashboard();
</script>
</body>
</html>
